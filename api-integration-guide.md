# 🔗 실제 API 연동 가이드

## 📊 구현된 API 연동

### 1. Yahoo Finance API (실시간 주가 데이터)
- **URL**: `/api/yahoo-finance/:symbol`
- **기능**: 한국 주식 실시간 시세 조회
- **특징**: 
  - 한국 주식명 자동 변환 (삼성전자 → 005930.KS)
  - 실시간 가격, 변동률, 거래량, 시장 상태 제공
  - 에러 시 백업 데이터 자동 사용

### 2. Gemini AI API (투자 리밸런싱 제안)
- **URL**: `/api/investment-advice`
- **기능**: AI 기반 포트폴리오 리밸런싱 제안
- **특징**:
  - 실시간 포트폴리오 데이터와 연동
  - 위험도, 목표수익률 기반 맞춤 제안
  - 안전 설정 및 프롬프트 최적화

### 3. KIS API (한국투자증권 - 준비 완료)
- **URL**: `/api/kis-token`, `/api/kis-stock/:code`
- **기능**: 한국 주식 전문 데이터
- **상태**: 서버 구현 완료, API 키 설정 후 사용 가능

## 🚀 실시간 기능 테스트

### 포트폴리오 분석 테스트
1. **입력 예시**:
   ```
   포트폴리오: 삼성전자 10주, 카카오 5, 네이버3
   투자금액: 10000000
   ```

2. **실시간 데이터 흐름**:
   ```
   사용자 입력 → Yahoo Finance API 호출 → 실시간 가격 조회 → 포트폴리오 분석
   ```

3. **결과 확인사항**:
   - ✅ 실시간 데이터 표시
   - ⚠️ 일부 데이터만 실시간 (나머지는 추정)
   - ❌ 네트워크 오류 시 백업 데이터 사용

### AI 리밸런싱 테스트
1. **실제 API 키 설정 시**:
   - `.env` 파일에 `GEMINI_API_KEY=your_key` 추가
   - 완전한 AI 분석 및 제안 제공

2. **데모 모드 (API 키 없음)**:
   - 위험도별 사전 정의된 제안 표시
   - "데모 모드" 알림 표시

## 🔧 API 키 설정 방법

### 1. `.env` 파일 생성
```bash
cp env-example.txt .env
```

### 2. API 키 입력
```env
# AI 모델
GEMINI_API_KEY=your_gemini_api_key_here

# 한국투자증권 (선택사항)
KIS_API_KEY=your_kis_api_key_here
KIS_API_SECRET=your_kis_api_secret_here

# 서버 설정
PORT=3001
NODE_ENV=development
```

### 3. 서버 재시작
```bash
npm run dev
```

## 📈 성능 모니터링

### 실시간 메트릭
- **API 응답 시간**: Yahoo Finance 평균 500-1500ms
- **포트폴리오 분석**: 병렬 처리로 3-5초 내 완료
- **AI 제안 생성**: Gemini API 10-30초

### 에러 핸들링
- **네트워크 오류**: 자동 백업 데이터 사용
- **API 한도 초과**: 캐시된 데이터 활용
- **타임아웃**: 사용자 친화적 오류 메시지

## 🎯 다음 단계 권장사항

1. **API 키 발급**:
   - [Google AI Studio](https://makersuite.google.com/app/apikey)에서 Gemini API 키 발급
   - [한국투자증권 KIS](https://apiportal.koreainvestment.com/)에서 API 키 발급 (선택)

2. **캐싱 시스템 구축**:
   - Redis 연동으로 API 호출 최적화
   - 실시간 데이터 캐시 전략 수립

3. **모니터링 강화**:
   - API 사용량 추적
   - 에러율 모니터링
   - 사용자 행동 분석

4. **보안 강화**:
   - API 키 암호화 저장
   - Rate limiting 구현
   - 사용자 인증 연동

## 💡 개발 팁

### 디버깅
- 브라우저 콘솔에서 실시간 API 호출 상태 확인
- Network 탭에서 응답 시간 모니터링
- `console.log`로 데이터 흐름 추적

### 테스트 데이터
- 잘 알려진 한국 주식명 사용 (삼성전자, 카카오, 네이버 등)
- 다양한 포트폴리오 규모 테스트
- 네트워크 연결 끊김 상황 시뮬레이션

### 성능 최적화
- 병렬 API 호출로 로딩 시간 단축
- 불필요한 API 호출 방지
- 사용자 경험 중심의 로딩 표시

---

**📞 지원**: 문제 발생 시 콘솔 로그와 함께 문의해주세요.
**🔄 업데이트**: 정기적으로 API 스펙 변경사항을 확인하세요.
